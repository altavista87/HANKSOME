06:31:15 - Device: cpu
06:31:15 - ============================================================
06:31:15 - MALAYSIA HANK - STAGE 2: EDUCATION
06:31:15 - Started: 2026-01-30 06:31:15
06:31:15 - ============================================================
06:31:15 - 
06:31:15 - Found Stage 1 model: /Users/sir/malaysia_hank/outputs/stage1/stage1_best.pt
06:31:15 - Note: Stage 2 uses extended architecture - training from scratch
06:31:15 - 
06:31:15 - Model parameters: 29,342
06:31:15 - 
06:31:16 - ============================================================
06:31:16 - STAGE 2: TRAINING HANK WITH EDUCATION
06:31:16 - ============================================================
06:31:16 - Parameters: 29,342
06:31:16 - Epochs: 2000, Device: cpu
06:31:16 - 
06:31:16 - Education System:
06:31:16 -   Levels: 3
06:31:16 -   Costs: [0.0, 0.5, 2.0]
06:31:16 -   Premiums: [1.0, 1.3, 2.0]
06:31:16 -   Max enrollment age: 25
06:31:16 - 
06:31:16 - Epoch    0 | Loss: 79932.882812 | C: 1.46, L: 36.5, I: 155.4 | Enroll: 37.65% | Time: 0.1s
06:31:16 -          Income Premium (Tertiary/Primary): 2.12x
06:31:16 - Epoch  100 | Loss: 579.276306 | C: 1.25, L: 22.1, I: 116.4 | Enroll: 27.71% | Time: 0.2s
06:31:16 -          Income Premium (Tertiary/Primary): 2.00x
06:31:16 - Epoch  200 | Loss: 213.744354 | C: 1.19, L: 20.6, I: 111.7 | Enroll: 29.80% | Time: 0.4s
06:31:16 -          Income Premium (Tertiary/Primary): 1.96x
06:31:16 - Epoch  300 | Loss: 136.036392 | C: 1.15, L: 19.9, I: 110.9 | Enroll: 29.56% | Time: 0.5s
06:31:16 -          Income Premium (Tertiary/Primary): 1.78x
06:31:16 - Epoch  400 | Loss: 139.647308 | C: 1.13, L: 19.7, I: 112.9 | Enroll: 33.37% | Time: 0.6s
06:31:16 -          Income Premium (Tertiary/Primary): 2.06x
06:31:17 - Epoch  500 | Loss: 97.522102 | C: 1.11, L: 18.9, I: 111.0 | Enroll: 36.26% | Time: 0.8s
06:31:17 -          Income Premium (Tertiary/Primary): 1.99x
06:31:17 - Epoch  600 | Loss: 97.000244 | C: 1.12, L: 19.1, I: 114.0 | Enroll: 38.83% | Time: 0.9s
06:31:17 -          Income Premium (Tertiary/Primary): 2.07x
06:31:17 - Epoch  700 | Loss: 84.041786 | C: 1.10, L: 18.6, I: 112.0 | Enroll: 40.48% | Time: 1.1s
06:31:17 -          Income Premium (Tertiary/Primary): 2.05x
06:31:17 - Epoch  800 | Loss: 59.630600 | C: 1.14, L: 19.3, I: 116.6 | Enroll: 38.88% | Time: 1.2s
06:31:17 -          Income Premium (Tertiary/Primary): 2.11x
06:31:17 - Epoch  900 | Loss: 77.955086 | C: 1.10, L: 18.4, I: 111.9 | Enroll: 35.33% | Time: 1.3s
06:31:17 -          Income Premium (Tertiary/Primary): 1.97x
06:31:17 - Epoch 1000 | Loss: 88.503380 | C: 1.10, L: 18.5, I: 111.9 | Enroll: 36.30% | Time: 1.5s
06:31:17 -          Income Premium (Tertiary/Primary): 2.11x
06:31:17 - Epoch 1100 | Loss: 93.794205 | C: 1.14, L: 19.3, I: 117.3 | Enroll: 39.46% | Time: 1.6s
06:31:17 -          Income Premium (Tertiary/Primary): 1.95x
06:31:18 - Epoch 1200 | Loss: 94.225975 | C: 1.07, L: 18.0, I: 109.0 | Enroll: 37.86% | Time: 1.8s
06:31:18 -          Income Premium (Tertiary/Primary): 2.05x
06:31:18 - Epoch 1300 | Loss: 64.540268 | C: 1.11, L: 18.7, I: 113.1 | Enroll: 37.52% | Time: 1.9s
06:31:18 -          Income Premium (Tertiary/Primary): 2.02x
06:31:18 - Epoch 1400 | Loss: 74.535568 | C: 1.07, L: 17.8, I: 107.9 | Enroll: 39.55% | Time: 2.0s
06:31:18 -          Income Premium (Tertiary/Primary): 1.90x
06:31:18 - Epoch 1500 | Loss: 65.405586 | C: 1.10, L: 18.5, I: 112.2 | Enroll: 39.36% | Time: 2.2s
06:31:18 -          Income Premium (Tertiary/Primary): 1.90x
06:31:18 - Epoch 1600 | Loss: 79.508682 | C: 1.12, L: 18.8, I: 113.7 | Enroll: 36.21% | Time: 2.3s
06:31:18 -          Income Premium (Tertiary/Primary): 2.12x
06:31:18 - Epoch 1700 | Loss: 75.608017 | C: 1.09, L: 18.3, I: 110.7 | Enroll: 39.76% | Time: 2.5s
06:31:18 -          Income Premium (Tertiary/Primary): 1.96x
06:31:18 - Epoch 1800 | Loss: 76.165390 | C: 1.10, L: 18.4, I: 111.5 | Enroll: 40.15% | Time: 2.6s
06:31:18 -          Income Premium (Tertiary/Primary): 1.82x
06:31:19 - Epoch 1900 | Loss: 81.813156 | C: 1.13, L: 19.0, I: 114.9 | Enroll: 36.09% | Time: 2.7s
06:31:19 -          Income Premium (Tertiary/Primary): 1.87x
06:31:19 - Epoch 1999 | Loss: 64.975471 | C: 1.14, L: 19.3, I: 117.4 | Enroll: 39.21% | Time: 2.9s
06:31:19 -          Income Premium (Tertiary/Primary): 1.90x
06:31:19 - 
06:31:19 - ============================================================
06:31:19 - TRAINING COMPLETE
06:31:19 - Best loss: 50.711697
06:31:19 - Total time: 0.0 minutes
06:31:19 - ============================================================
06:31:19 - Saved diagnostics: /Users/sir/malaysia_hank/outputs/stage2/stage2_diagnostics.png
06:31:19 - 
06:31:19 - ============================================================
06:31:19 - STAGE 2 VALIDATION
06:31:19 - ============================================================
06:31:19 - Steady State (n=10000):
06:31:19 -   Mean liquid assets:      RM 25
06:31:19 -   Mean illiquid (EPF):     RM 100
06:31:19 -   Total wealth:            RM 125
06:31:19 -   Mean consumption:        RM 1.11
06:31:19 -   Mean income (with edu):  RM 2.70
06:31:19 -   Consumption/Income:      41.1%
06:31:19 -   Approx MPC:              0.589
06:31:19 -   Budget residual:         0.0596
06:31:19 - 
06:31:19 - Education Moments:
06:31:19 -   Tertiary enrollment (young): 38.4%
06:31:19 -   Fraction young (age < 25):   14.6%
06:31:19 - 
06:31:19 - Income by Education Level:
06:31:19 -   Primary   : n=3283, Income=RM1.87, C=RM1.20
06:31:19 -   Secondary : n=3360, Income=RM2.42, C=RM1.11
06:31:19 -   Tertiary  : n=3357, Income=RM3.80, C=RM1.02
06:31:19 - 
06:31:19 - Wage Premiums (Relative to Primary):
06:31:19 -   Secondary: 1.29x (target: 1.3x)
06:31:19 -   Tertiary:  2.04x (target: 2.0x)
06:31:19 - 
06:31:19 - Data Targets:
06:31:19 -   Income Gini:             0.412
06:31:19 -   Formal sector share:     64.0%
06:31:19 -   Informal sector share:   28.0%
06:31:19 - 
06:31:19 - Validation Checks:
06:31:19 -   Budget residual < 0.1                    ✓ PASS
06:31:19 -   Consumption positive                     ✓ PASS
06:31:19 -   Assets non-negative                      ✓ PASS
06:31:19 -   MPC reasonable                           ✓ PASS
06:31:19 -   Consumption < Income                     ✓ PASS
06:31:19 -   Wage premium tertiary > 1.5x             ✓ PASS
06:31:19 -   Tertiary enrollment > 10%                ✓ PASS
06:31:19 - 
06:31:19 - ✓ ALL VALIDATION CHECKS PASSED
06:31:19 -   Ready for Stage 3: Add health
06:31:19 - 
06:31:19 - ============================================================
06:31:19 - STAGE 2 COMPLETE
06:31:19 - Finished: 2026-01-30 06:31:19
06:31:19 - ============================================================
06:31:19 - Outputs:
06:31:19 -   - Model: /Users/sir/malaysia_hank/outputs/stage2/stage2_best.pt
06:31:19 -   - History: /Users/sir/malaysia_hank/outputs/stage2/training_history.csv
06:31:19 -   - Diagnostics: /Users/sir/malaysia_hank/outputs/stage2/stage2_diagnostics.png
06:31:19 -   - Validation: /Users/sir/malaysia_hank/outputs/stage2/validation_results.json
06:31:19 -   - Log: /Users/sir/malaysia_hank/outputs/stage2/training_log.txt
06:31:19 - 
06:31:19 - Next: Stage 3 - Add Health module
20:35:45 - Device: cpu
20:35:45 - ============================================================
20:35:45 - MALAYSIA HANK - STAGE 2: EDUCATION
20:35:45 - Started: 2026-02-03 20:35:45
20:35:45 - ============================================================
20:35:45 - 
20:35:45 - Found Stage 1 model: outputs/stage1/stage1_best.pt
20:35:45 - Note: Stage 2 uses extended architecture - training from scratch
20:35:45 - 
20:35:45 - Model parameters: 29,342
20:35:45 - 
20:35:46 - ============================================================
20:35:46 - STAGE 2: TRAINING HANK WITH EDUCATION
20:35:46 - ============================================================
20:35:46 - Parameters: 29,342
20:35:46 - Epochs: 2000, Device: cpu
20:35:46 - 
20:35:46 - Education System:
20:35:46 -   Levels: 3
20:35:46 -   Costs: [0.0, 0.5, 2.0]
20:35:46 -   Premiums: [1.0, 1.3, 2.0]
20:35:46 -   Max enrollment age: 25
20:35:46 - 
20:35:46 - Epoch    0 | Loss: 46116.675781 | C: 1.53, L: 36.8, I: 123.8 | Enroll: 34.13% | Time: 0.1s
20:35:46 -          Income Premium (Tertiary/Primary): 1.97x
20:35:46 - Epoch  100 | Loss: 276.551727 | C: 1.13, L: 26.3, I: 109.4 | Enroll: 27.57% | Time: 0.2s
20:35:46 -          Income Premium (Tertiary/Primary): 1.98x
20:35:46 - Epoch  200 | Loss: 200.529297 | C: 1.02, L: 23.6, I: 100.8 | Enroll: 26.55% | Time: 0.3s
20:35:46 -          Income Premium (Tertiary/Primary): 1.92x
20:35:46 - Epoch  300 | Loss: 143.767197 | C: 1.01, L: 23.5, I: 105.9 | Enroll: 31.00% | Time: 0.5s
20:35:46 -          Income Premium (Tertiary/Primary): 1.98x
20:35:46 - Epoch  400 | Loss: 110.217957 | C: 1.01, L: 23.7, I: 109.1 | Enroll: 32.59% | Time: 0.6s
20:35:46 -          Income Premium (Tertiary/Primary): 1.92x
20:35:46 - Epoch  500 | Loss: 90.639626 | C: 0.97, L: 22.9, I: 106.5 | Enroll: 33.77% | Time: 0.7s
20:35:46 -          Income Premium (Tertiary/Primary): 1.96x
20:35:46 - Epoch  600 | Loss: 76.294296 | C: 0.99, L: 23.3, I: 108.9 | Enroll: 37.96% | Time: 0.9s
20:35:46 -          Income Premium (Tertiary/Primary): 2.01x
20:35:47 - Epoch  700 | Loss: 92.518333 | C: 0.94, L: 21.8, I: 101.4 | Enroll: 39.27% | Time: 1.0s
20:35:47 -          Income Premium (Tertiary/Primary): 2.05x
20:35:47 - Epoch  800 | Loss: 87.193489 | C: 1.00, L: 23.3, I: 110.2 | Enroll: 39.78% | Time: 1.2s
20:35:47 -          Income Premium (Tertiary/Primary): 2.08x
20:35:47 - Epoch  900 | Loss: 90.663406 | C: 0.99, L: 23.1, I: 109.1 | Enroll: 36.56% | Time: 1.3s
20:35:47 -          Income Premium (Tertiary/Primary): 1.94x
20:35:47 - Epoch 1000 | Loss: 75.403625 | C: 0.97, L: 22.6, I: 106.2 | Enroll: 39.16% | Time: 1.4s
20:35:47 -          Income Premium (Tertiary/Primary): 2.19x
20:35:47 - Epoch 1100 | Loss: 81.918922 | C: 0.98, L: 23.0, I: 108.3 | Enroll: 41.01% | Time: 1.6s
20:35:47 -          Income Premium (Tertiary/Primary): 2.24x
20:35:47 - Epoch 1200 | Loss: 93.802536 | C: 0.96, L: 22.6, I: 106.4 | Enroll: 39.23% | Time: 1.7s
20:35:47 -          Income Premium (Tertiary/Primary): 2.04x
20:35:47 - Epoch 1300 | Loss: 74.662231 | C: 0.98, L: 22.8, I: 108.0 | Enroll: 37.63% | Time: 1.8s
20:35:47 -          Income Premium (Tertiary/Primary): 1.91x
20:35:48 - Epoch 1400 | Loss: 89.165115 | C: 1.01, L: 23.7, I: 112.2 | Enroll: 39.74% | Time: 2.0s
20:35:48 -          Income Premium (Tertiary/Primary): 1.81x
20:35:48 - Epoch 1500 | Loss: 73.294479 | C: 0.99, L: 23.2, I: 109.5 | Enroll: 39.36% | Time: 2.1s
20:35:48 -          Income Premium (Tertiary/Primary): 2.01x
20:35:48 - Epoch 1600 | Loss: 70.610374 | C: 0.99, L: 23.3, I: 110.1 | Enroll: 40.21% | Time: 2.2s
20:35:48 -          Income Premium (Tertiary/Primary): 2.02x
20:35:48 - Epoch 1700 | Loss: 70.181786 | C: 0.97, L: 22.6, I: 106.3 | Enroll: 39.34% | Time: 2.4s
20:35:48 -          Income Premium (Tertiary/Primary): 1.88x
20:35:48 - Epoch 1800 | Loss: 75.325302 | C: 1.03, L: 24.2, I: 114.9 | Enroll: 40.38% | Time: 2.5s
20:35:48 -          Income Premium (Tertiary/Primary): 2.03x
20:35:48 - Epoch 1900 | Loss: 65.718300 | C: 1.00, L: 23.4, I: 110.7 | Enroll: 38.87% | Time: 2.6s
20:35:48 -          Income Premium (Tertiary/Primary): 2.05x
20:35:48 - Epoch 1999 | Loss: 91.162247 | C: 1.00, L: 23.5, I: 111.5 | Enroll: 38.48% | Time: 2.8s
20:35:48 -          Income Premium (Tertiary/Primary): 2.16x
20:35:48 - 
20:35:48 - ============================================================
20:35:48 - TRAINING COMPLETE
20:35:48 - Best loss: 52.781681
20:35:48 - Total time: 0.0 minutes
20:35:48 - ============================================================
20:35:49 - Saved diagnostics: outputs/stage2/stage2_diagnostics.png
20:35:49 - 
20:35:49 - ============================================================
20:35:49 - STAGE 2 VALIDATION
20:35:49 - ============================================================
20:35:49 - Steady State (n=10000):
20:35:49 -   Mean liquid assets:      RM 25
20:35:49 -   Mean illiquid (EPF):     RM 101
20:35:49 -   Total wealth:            RM 126
20:35:49 -   Mean consumption:        RM 0.99
20:35:49 -   Mean income (with edu):  RM 2.69
20:35:49 -   Consumption/Income:      36.8%
20:35:49 -   Approx MPC:              0.513
20:35:49 -   Budget residual:         -0.0043
20:35:49 - 
20:35:49 - Education Moments:
20:35:49 -   Tertiary enrollment (young): 39.0%
20:35:49 -   Fraction young (age < 25):   14.4%
20:35:49 - 
20:35:49 - Income by Education Level:
20:35:49 -   Primary   : n=3381, Income=RM1.85, C=RM0.91
20:35:49 -   Secondary : n=3238, Income=RM2.45, C=RM1.08
20:35:49 -   Tertiary  : n=3381, Income=RM3.76, C=RM0.97
20:35:49 - 
20:35:49 - Wage Premiums (Relative to Primary):
20:35:49 -   Secondary: 1.32x (target: 1.3x)
20:35:49 -   Tertiary:  2.04x (target: 2.0x)
20:35:49 - 
20:35:49 - Data Targets:
20:35:49 -   Income Gini:             0.412
20:35:49 -   Formal sector share:     64.0%
20:35:49 -   Informal sector share:   28.0%
20:35:49 - 
20:35:49 - Validation Checks:
20:35:49 -   Budget residual < 0.1                    ✓ PASS
20:35:49 -   Consumption positive                     ✓ PASS
20:35:49 -   Assets non-negative                      ✓ PASS
20:35:49 -   MPC reasonable                           ✓ PASS
20:35:49 -   Consumption < Income                     ✓ PASS
20:35:49 -   Wage premium tertiary > 1.5x             ✓ PASS
20:35:49 -   Tertiary enrollment > 10%                ✓ PASS
20:35:49 - 
20:35:49 - ✓ ALL VALIDATION CHECKS PASSED
20:35:49 -   Ready for Stage 3: Add health
20:35:49 - 
20:35:49 - ============================================================
20:35:49 - STAGE 2 COMPLETE
20:35:49 - Finished: 2026-02-03 20:35:49
20:35:49 - ============================================================
20:35:49 - Outputs:
20:35:49 -   - Model: outputs/stage2/stage2_best.pt
20:35:49 -   - History: outputs/stage2/training_history.csv
20:35:49 -   - Diagnostics: outputs/stage2/stage2_diagnostics.png
20:35:49 -   - Validation: outputs/stage2/validation_results.json
20:35:49 -   - Log: outputs/stage2/training_log.txt
20:35:49 - 
20:35:49 - Next: Stage 3 - Add Health module
